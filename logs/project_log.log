2025-09-05 19:18:16 | INFO | Connecting to Kafka broker at localhost:9092...
2025-09-05 19:18:16 | INFO | Kafka producer successfully created.
2025-09-05 19:18:16 | INFO | Kafka broker address: localhost:9092
2025-09-05 19:18:17 | INFO | Topic 'attendance_csv' already exists. Recreating fresh...
2025-09-05 19:18:17 | INFO | Requested deletion of topic 'attendance_csv'.
2025-09-05 19:18:17 | INFO | Topic 'attendance_csv' created successfully.
2025-09-05 19:18:17 | INFO | Kafka topic 'attendance_csv' is ready.
2025-09-05 19:18:17 | INFO | Starting message production to topic 'attendance_csv'...
2025-09-05 19:18:17 | INFO | Opening data file in read mode: ~/OneDrive/Desktop/Masters/Streaming Data/Mod 3/buzzline-03-schroder/data/attendance.csv
2025-09-05 19:18:17 | INFO | Reading data from file: ~/OneDrive/Desktop/Masters/Streaming Data/Mod 3/buzzline-03-schroder/data/attendance.csv
2025-09-05 19:18:17 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Taylor Swift', 'course': 'Algebra', 'status': 'present'}
2025-09-05 19:18:19 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Elon Musk', 'course': 'Algebra', 'status': 'late'}
2025-09-05 19:18:21 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Beyonce Knowles', 'course': 'Algebra', 'status': 'late'}
2025-09-05 19:18:23 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Tom Hanks', 'course': 'Algebra', 'status': 'absent'}
2025-09-05 19:18:25 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Serena Williams', 'course': 'Algebra', 'status': 'present'}
2025-09-05 19:18:27 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Keanu Reeves', 'course': 'Algebra', 'status': 'present'}
2025-09-05 19:18:29 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Emma Watson', 'course': 'Algebra', 'status': 'present'}
2025-09-05 19:18:31 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Dwayne Johnson', 'course': 'Algebra', 'status': 'late'}
2025-09-05 19:18:33 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Oprah Winfrey', 'course': 'Algebra', 'status': 'present'}
2025-09-05 19:18:35 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T08:00:00Z', 'student': 'Cristiano Ronaldo', 'course': 'Algebra', 'status': 'present'}
2025-09-05 19:18:35 | INFO | Logging to file: logs/project_log.log
2025-09-05 19:18:35 | INFO | Log sanitization enabled, personal info removed
2025-09-05 19:18:35 | INFO | START attendance consumer (schroder).
2025-09-05 19:18:35 | INFO | Kafka topic: attendance_csv
2025-09-05 19:18:35 | INFO | Kafka consumer group id: attendance_group
2025-09-05 19:18:35 | INFO | Consumer: Topic 'attendance_csv' and group 'attendance_group'...
2025-09-05 19:18:35 | INFO | Config: WINDOW=10, RATE<85%, CHRONIC_WINDOW_DAYS=7, CHRONIC_ABSENCES>=2, LATE_BURST>=3
2025-09-05 19:18:35 | INFO | Kafka broker address: localhost:9092
2025-09-05 19:18:35 | INFO | Creating Kafka consumer. Topic='attendance_csv' and group ID='attendance_group'.
2025-09-05 19:18:35 | INFO | Kafka consumer created successfully.
2025-09-05 19:18:35 | INFO | Polling messages from topic 'attendance_csv'...
2025-09-05 19:18:37 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Taylor Swift', 'course': 'Geometry', 'status': 'present'}
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Elon Musk → late
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Beyonce Knowles → late
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Tom Hanks → absent
2025-09-05 19:18:38 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Algebra' date=2025-09-05 rate=67% (< 85%)
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Serena Williams → present
2025-09-05 19:18:38 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Algebra' date=2025-09-05 rate=75% (< 85%)
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Keanu Reeves → present
2025-09-05 19:18:38 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Algebra' date=2025-09-05 rate=80% (< 85%)
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Emma Watson → present
2025-09-05 19:18:38 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Algebra' date=2025-09-05 rate=83% (< 85%)
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Dwayne Johnson → late
2025-09-05 19:18:38 | WARNING | LATE_BURST_CLASS: course='Algebra' date=2025-09-05 lates=3 (>= 3)
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Oprah Winfrey → present
2025-09-05 19:18:38 | INFO | [2025-09-05 04:00] Algebra | Cristiano Ronaldo → present
2025-09-05 19:18:38 | INFO | [2025-09-05 06:00] Geometry | Taylor Swift → present
2025-09-05 19:18:39 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Elon Musk', 'course': 'Geometry', 'status': 'present'}
2025-09-05 19:18:39 | INFO | [2025-09-05 06:00] Geometry | Elon Musk → present
2025-09-05 19:18:41 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Beyonce Knowles', 'course': 'Geometry', 'status': 'absent'}
2025-09-05 19:18:41 | INFO | [2025-09-05 06:00] Geometry | Beyonce Knowles → absent
2025-09-05 19:18:41 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=67% (< 85%)
2025-09-05 19:18:43 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Tom Hanks', 'course': 'Geometry', 'status': 'absent'}
2025-09-05 19:18:43 | INFO | [2025-09-05 06:00] Geometry | Tom Hanks → absent
2025-09-05 19:18:43 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=50% (< 85%)
2025-09-05 19:18:43 | WARNING | CHRONIC_ABSENCE_STUDENT: student='Tom Hanks' absences_last_7d=2 (>= 2)
2025-09-05 19:18:45 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Serena Williams', 'course': 'Geometry', 'status': 'late'}
2025-09-05 19:18:45 | INFO | [2025-09-05 06:00] Geometry | Serena Williams → late
2025-09-05 19:18:45 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=60% (< 85%)
2025-09-05 19:18:47 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'LeBron James', 'course': 'Geometry', 'status': 'present'}
2025-09-05 19:18:47 | INFO | [2025-09-05 06:00] Geometry | LeBron James → present
2025-09-05 19:18:47 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=67% (< 85%)
2025-09-05 19:18:49 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Emma Watson', 'course': 'Geometry', 'status': 'present'}
2025-09-05 19:18:49 | INFO | [2025-09-05 06:00] Geometry | Emma Watson → present
2025-09-05 19:18:49 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=71% (< 85%)
2025-09-05 19:18:51 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Oprah Winfrey', 'course': 'Geometry', 'status': 'present'}
2025-09-05 19:18:51 | INFO | [2025-09-05 06:00] Geometry | Oprah Winfrey → present
2025-09-05 19:18:51 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=75% (< 85%)
2025-09-05 19:18:53 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Cristiano Ronaldo', 'course': 'Geometry', 'status': 'late'}
2025-09-05 19:18:53 | INFO | [2025-09-05 06:00] Geometry | Cristiano Ronaldo → late
2025-09-05 19:18:53 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=78% (< 85%)
2025-09-05 19:18:55 | INFO | Sent message to topic 'attendance_csv': {'ts': '2025-09-05T10:00:00Z', 'student': 'Lionel Messi', 'course': 'Geometry', 'status': 'present'}
2025-09-05 19:18:55 | INFO | [2025-09-05 06:00] Geometry | Lionel Messi → present
2025-09-05 19:18:55 | WARNING | ATTENDANCE_DROP_CLASS (window): course='Geometry' rate=80% over last 10 events (< 85%)
2025-09-05 19:18:55 | WARNING | ATTENDANCE_DROP_CLASS (daily): course='Geometry' date=2025-09-05 rate=80% (< 85%)
2025-09-05 19:18:56 | WARNING | Producer interrupted by user.
2025-09-05 19:18:56 | INFO | Kafka producer closed.
2025-09-05 19:18:56 | INFO | END attendance producer (schroder).
